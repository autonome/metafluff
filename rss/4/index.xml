<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Dietrich Ayala]]></title><description><![CDATA[Internet freedom, the web and Mozilla.]]></description><link>/</link><generator>Ghost</generator><lastBuildDate>Thu, 20 Jul 2017 12:11:33 GMT</lastBuildDate><atom:link href="/rss/index.xml" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Jetpacking: The 0.3 SDK and a peek at what's coming next.]]></title><description><![CDATA[<p>I&#39;ve been working on the Jetpack project for about a month now - implementing features, fixing bugs, and generally helping move things forward as we build out the wide set of capabilities needed to enable an <em>awesome</em> future for Firefox add-on development.</p>
<p>The Jetpack team <a href="http://mozillalabs.com/jetpack/2010/04/29/announcing-jetpack-sdk-0-3/">released the 0.3 version of the SDK</a> yesterday, which has a bunch of platform improvements, and also the <a href="https://jetpack.mozillalabs.com/sdk/0.3/docs/#module/jetpack-core/context-menu">context menu API</a> - the first UI feature to ship in the SDK. The <a href="https://jetpack.mozillalabs.com/sdk/0.3/docs/#guide/programs">SDK documentation has an example</a> of using this feature that shows 1) how easy it is to build UI features with Jetpack, but also 2) shows how add-on development process has <em>changed</em> with the SDK. For example, all of the manual packaging steps are <em>gone</em>. That&#39;s right. No more crazy directory structures, no more RDF files, no more GUIDs. All of that stuff is gone, replaced with a couple of simple commands. It&#39;s not perfect yet, but expect it to get even easier to both package and deploy add-ons as we build out the SDK further.</p>
<p>So what&#39;s next? The 0.4 release is where the feature set of the SDK really starts to blow up:</p>
<ul>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/103">Panels</a>: Floating rich content, tooltips, contextual UI.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/116">Private Browsing</a>: Making it easy for add-ons to respect your privacy.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/111">Selection</a>: Remember how awesome it was having an intuitive selection API in Ubiquity?</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/113">Localization</a>: Simple access and distribution of locale data.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/108">Page Worker</a>: Like a <a href="https://developer.mozilla.org/En/Using_web_workers">Web Worker</a>, but with more privileges and a DOM.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/104">Simple Storage</a>: Persistent object store - like DOMStorage for add-ons.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/114">Places</a>: Improved bookmarks and history searching and browsing.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/102">Widgets</a>: A preview of the ideas <a href="http://mozillalabs.com/jetpack/2010/04/08/the-single-ui-element/">Daniel</a> and <a href="http://jboriss.wordpress.com/2010/04/29/removing-firefoxs-status-bar-and-rehousing-add-on-icons-part-1-of-2/">Boriss</a> have recently blogged about.</li>
<li><a href="https://wiki.mozilla.org/Labs/Jetpack/Reboot/JEP/109">Request</a>: Even easier AJAX (Please don&#39;t make that into an acronym. Please.)</li>
<li>Installable without needing to restart Firefox (trunk builds only).</li>
<li>Documentation: More and better!
And it&#39;s not just about the feature set: The diligent focus of the Jetpack core team on developer ergonomics, and the experience gained from the Jetpack prototype and projects like Ubiquity, is resulting in a set of APIs that are far more intuitive and easy to use than the current XPCOM-riddled minefield that add-on developers have to deal with today.</li>
</ul>
<p>If you have questions or suggestions, let me know in the comments, or join us on <a href="http://groups.google.com/group/mozilla-labs-jetpack">Jetpack developer forum</a>.</p>
]]></description><link>/2010/05/jetpacking-the-0-3-sdk-and-a-peek-at-whats-coming-next/index.html</link><guid isPermaLink="true">/2010/05/jetpacking-the-0-3-sdk-and-a-peek-at-whats-coming-next/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[jetpack]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 01 May 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Performance Update]]></title><description><![CDATA[<p>I&#39;ve been focusing more on <a href="https://wiki.mozilla.org/Labs/Jetpack">Jetpack</a> development this quarter, but will still be posting performance round-ups regularly here. In fact, here&#39;s one now:</p>
<ul>
<li>Taras Glek continues to blog his progress on improving the binaries we ship, talking about <a href="http://blog.mozilla.com/tglek/2010/04/05/linux-how-to-make-startup-suck-less-and-reduce-memory-usage/">how reordering binaries improves memory use as well as load time</a>, <a href="http://blog.mozilla.com/tglek/2010/04/12/squeezing-every-last-bit-of-performance-out-of-the-linux-toolchain/">leveraging GCC&#39;s PGO for fast startup</a>, and finally about <a href="http://blog.mozilla.com/tglek/2010/04/07/icegrind-valgrind-plugin-for-optimizing-cold-startup/">Icegrind, his Valgrind plugin</a> that generates a log of the order of access to mmap&#39;d files.</li>
<li>Are we fast yet?! The answer to that question, at least in regards to JavaScript performance test suites, can be found at <a href="http://arewefastyet.com/">AreWeFastYet.com</a>, where you&#39;ll see graphs that show Firefox trunk&#39;s performance relative to Google&#39;s V8 and Apple&#39;s Nitro on the Sunspider and V8Bench tests. I won&#39;t spoil the answer for you, you&#39;ll have to go check it out for yourself.</li>
<li>I <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=557552">finished and checked-in</a> my changes to the <a href="http://tests.themasta.com/tinderboxpushlog/?tree=Firefox">Tinderbox Pushlog</a>, adding a new feature that provides at-a-glance comparison in performance test results between any two pushes on the page (<a href="https://bug557552.bugzilla.mozilla.org/attachment.cgi?id=437335">screenshot</a>). It will go live next time Marcus pushes changes out to his server. <span style="text-decoration:line-through;">But he&#39;s not online at the moment, so I don&#39;t know when this feature will go live.</span> Heh, it went live moments after I published this post.</li>
<li>Heather Arthur and Clint Talbert are working on a project to add performance data to Addons.mozilla.org for extensions. They&#39;re starting with the effect of a given extension on Firefox startup time. Follow along on the <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=559929">bug</a>, or <a href="http://github.com/harthur/dirtyharry">watch project Dirty Harry on Github</a>.</li>
<li>Improving the AMO extension validator: AMO scans uploaded extensions and reports problems to the authors. For performance best-practices, we should at least warn the authors if possible if their add-on is doing something that&#39;ll make Firefox slow. This bug is for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=551714">warning about add-ons that don&#39;t have their content in a JAR file</a>. If you see any thing in the <a href="https://wiki.mozilla.org/Performance/Addons/BestPractices">best practices guide</a> that can be statically detected, please file a bug for it <a href="https://bugzilla.mozilla.org/enter_bug.cgi?product=addons.mozilla.org&amp;component=Admin%2fEditor%20Tools">here</a>.
If you have any other performance-related bugs, blog posts, anecdotes or other tomfoolery, post it in the comments!</li>
</ul>
]]></description><link>/2010/04/firefox-performance-update-2/index.html</link><guid isPermaLink="true">/2010/04/firefox-performance-update-2/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 17 Apr 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Performance Update]]></title><description><![CDATA[<p>As I mentioned in <a href="http://autonome.wordpress.com/2010/03/19/firefox-performance-update-startup-and-otherwise-march-19-2010/">my previous update</a>, the scope of these updates has expanded beyond start-up time. That said, I can&#39;t keep track of everything! So if you have an update, <a href="mailto:dietrich@mozilla.com">email it to me</a> if you want it in the post, or just add it in the comments.</p>
<ul>
<li>First, I just have to say that Marco&#39;s fix for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=542943">bug 542943</a> has changed the way I think about browser restarts, removing the fear entirely. It turns out that, for me anyway, the majority of the slowness involved in restarting was waiting for the process to exit. After Marco&#39;s landing, it&#39;s nearly instantaneous.</li>
<li>While I was away, Taras blogged nearly daily about his findings while working on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=549749">Linux code locality</a>. He first posted <a href="http://blog.mozilla.com/tglek/2010/03/23/when-in-trouble-draw-a-picture/">a graph of I/O from library loading</a>, then a long post about <a href="http://blog.mozilla.com/tglek/2010/03/24/linux-why-loading-binaries-from-disk-sucks/">why library loading sucks on Linux</a>, followed by some findings regarding <a href="http://blog.mozilla.com/tglek/2010/03/25/madvise-prelink-update/">madvise and prelink</a>, finally posting about <a href="http://blog.mozilla.com/tglek/2010/03/29/linux-startup-inefficiency/">linker inefficiencies and SuSE&#39;s workaround</a>.</li>
<li>Mike Wu and others are moving forward on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=552121">the &quot;omnijar&quot; project</a>, which moves most of the core application files into a single JAR file. Taras described it as &quot;extreme filesystem makeover&quot;, and found ~10% start-up improvement with this approach on the desktop.</li>
<li>Clint Talbert and Heather Arthur are beginning work on a project that measures add-on performance, that will hook into AMO to show developers how their add-ons perform.</li>
<li>Drew Willcoxon got r+ on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=536893">bug 536893</a> to allow asynchronous opening of Places query results. Once we start using the feature, expect bookmark and history UI to get snappier!</li>
<li>Taras got review on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=516085">bug 516085</a>, which consolidates access to core services that currently accessed hundreds of thousands of times during a browsing session.</li>
<li>A bunch of people have added tips to the <a href="https://wiki.mozilla.org/Performance/Addons/BestPractices">add-on performance &quot;best practices&quot; document</a>. I&#39;ll be cleaning it up and moving it to <a href="https://developer.mozilla.org">MDC</a> soon.</li>
<li><p>While the tinderbox pushlog is fantastic for viewing per-checkin results, and a broader view of tree activity, it doesn&#39;t provide any facility for comparing the results of performance tests between landings. So I spent some time this week writing an addition that allows you to select any two pushes, and view a comparison table showing the difference in performance across all tests on all operating systems for those revisions. I&#39;ll clean it up, and try to get it deployed, but regardless will make it available as a Jetpack or Greasemonkey script sometime next week.
For more info:</p>
</li>
<li><p>Startup performance activity is tracked <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements">here</a>.</p>
</li>
<li>Add-on performance efforts are being tracked on <a href="https://wiki.mozilla.org/Performance/Addons">this page</a>.</li>
<li>Weekly performance results for all measurements are available on the <a href="http://graphs.mozilla.org/dashboard/snapshot/">snapshot</a>, and trends available on the <a href="http://graphs.mozilla.org/dashboard/">dashboard</a>.</li>
</ul>
]]></description><link>/2010/04/firefox-performance-update/index.html</link><guid isPermaLink="true">/2010/04/firefox-performance-update/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 03 Apr 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Performance Report, Startup and Otherwise - March 19, 2010]]></title><description><![CDATA[<p>A couple of notices: First, I&#39;m going to start including various performance-related items in these  posts that aren&#39;t purely about startup time. There&#39;s a whole bunch of activity happening that isn&#39;t really rolled up anywhere, so it might as well be here. Second, I&#39;ll be out on vacation in Florida next week, so there will not be a status update.</p>
<ul>
<li>Last week I forgot to add that Marco Bonardo landed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=542943">bug 542943</a>, which removed a hash of all bookmarks that stayed resident for the lifetime of the application. This resulted in a 97% improvement in shutdown time for our test of a very large bookmarks+history collection.</li>
<li>Ted&#39;s taken over the <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">static build project</a>, and has new patches up.</li>
<li>Taras is working on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=531406">Linux code locality</a> via a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=549749">Valgrind plugin he&#39;s writing</a>, with help from those folks.</li>
<li>At the platform work week Taras talked to Ehsan, who it turns out had a bunch of ideas for improving startup there. I&#39;ve filed bugs from Ehsan&#39;s notes for better <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=553721">Windows code locality</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=553723">binding DLL function addresses to the executable</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=553725">DLL rebasing</a>, and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=553727">DLL lazy-loading</a>.</li>
<li>The <a href="https://wiki.mozilla.org/Performance/Addons/BestPractices">add-on performance &quot;best practices&quot; document</a> is getting bigger and better. If you have ideas for improving add-on performance, please add them to the doc!</li>
<li>All of our add-on performance efforts are being tracked centrally on <a href="https://wiki.mozilla.org/Performance/Addons">this page</a>. If you want to get involved, hop on one of those bugs. If you want to stay updated, &quot;watch&quot; that page and you&#39;ll get emails whenever it&#39;s updated.</li>
<li>I&#39;ve updated the main <a href="https://wiki.mozilla.org/Performance">Performance wiki page</a>. The top sections are now up to date. Next I&#39;ll be updating the testing and reference sections, and breaking out the task-specific content and moving it to an updated table of performance activities, like we currently have for startup, addons, etc. When the page is more manageable, I&#39;ll remove the TOC that&#39;s pushing everything below the fold.</li>
<li>As usual, the table of active startup performance activity is <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements">here</a>.</li>
</ul>
]]></description><link>/2010/03/firefox-performance-update-startup-and-otherwise-march-19-2010/index.html</link><guid isPermaLink="true">/2010/03/firefox-performance-update-startup-and-otherwise-march-19-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 20 Mar 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance March 12, 2010]]></title><description><![CDATA[<p>No update on the ongoing code projects this week. However, we investigated the extension performance work I mentioned <a href="http://autonome.wordpress.com/2010/03/05/firefox-startup-performance-march-5-2010/">last week</a>, and got a conversation going, with posts by <a href="http://blog.mozilla.com/tglek/2010/03/11/extensions-startup/">Taras</a>, <a href="http://weblogs.mozillazine.org/asa/archives/2010/03/startup_penalty_repo.html">Asa</a> and <a href="http://autonome.wordpress.com/2010/03/10/firefox-extensions-and-performance/">myself</a>. I&#39;ve listed the various ideas and approaches that came out of those posts and comments <a href="https://wiki.mozilla.org/Performance/Addons">here</a>.</p>
]]></description><link>/2010/03/firefox-startup-performance-march-12-2010/index.html</link><guid isPermaLink="true">/2010/03/firefox-startup-performance-march-12-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 13 Mar 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox, Extensions and Performance]]></title><description><![CDATA[<p>Extensibility is a double-edged sword. It&#39;s a keystone feature in Firefox - differentiating even now that just about every other browser has some vector for augmentation. However, along with the freedom and power of Firefox extensions comes the ability to slow the browser down. And worse, users and developers have little or no visibility into the causes of poor extension performance.</p>
<p>Not all extensions slow Firefox down. But they can. To prevent that, we need to do three things:</p>
<ol>
<li>Make it <em>easy</em> for extension developers to keep their extensions fast.</li>
<li>Allow users to see the performance effect of their extensions.</li>
<li>Mitigate the effects of badly-behaving extensions in Firefox itself.</li>
</ol>
<h3 id="for-extension-developers">For Extension Developers</h3>
<p>First, we need to loudly and clearly educate extension developers, and provide them tools. Some ideas:</p>
<ul>
<li>Write an extension performance &quot;best practices&quot; guide on MDC.</li>
<li>Build warnings into Firefox, that highlight code that might perform poorly (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=550242">bug 550242</a>).</li>
<li>Provide a <a href="https://wiki.mozilla.org/Build:TryServer">try-server</a> that allows extensions to be uploaded and installed into the test profile.</li>
<li>Perform automated performance testing of extensions upload to AMO (<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=458990">bug 458990</a>, maybe?)</li>
<li>Ensure that Jetpack generates extensions that are models for good behavior.</li>
</ul>
<h3 id="for-users">For Users</h3>
<p>Users should be able to make informed choices about the extensions they install, and be able to monitor the effect of extensions on their browsing sessions. We could:</p>
<ul>
<li>Provide performance information for extensions on their pages on AMO.</li>
<li>Build a performance dashboard similar to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=515354">about:memory</a>, but tracking startup time, page-load time, and browser UI behavior such as menu responsiveness. Given a visualization of these things over time, users can see the effects of installing different extensions.</li>
</ul>
<h3 id="in-the-core">In the Core</h3>
<p>There are also things we can do to mitigate poor performance in core Firefox code. This is being discussed in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=533038">bug 533038</a>.</p>
<p>We&#39;re already working on some of the ideas listed above. Ping me in <a href="irc://irc.mozilla.org/#startup">#startup on irc.mozilla.org</a> if you want to help out. If you have ideas for other ways to improve extension performance, or to communicate back to users and developers, let me know in the comments.</p>
]]></description><link>/2010/03/firefox-extensions-and-performance/index.html</link><guid isPermaLink="true">/2010/03/firefox-extensions-and-performance/index.html</guid><category><![CDATA[extensions]]></category><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Thu, 11 Mar 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - March 5, 2010]]></title><description><![CDATA[<p>I spent the week on-site at Mozilla HQ in Mountain View, which was great.</p>
<ul>
<li>Talked with Bob Moss and others about expanding our startup tests to cover a <a href="https://wiki.mozilla.org/Firefox/Projects/StartupPerformance/TestMatrix">variety of startup scenarios</a>.</li>
<li>Spent some time tracing file IO with the top 10 extensions on AMO installed, comparing it to an empty profile (<a href="http://people.mozilla.com/~dietrich/open.empty.txt">empty</a>, <a href="http://people.mozilla.com/~dietrich/open.extensions.txt">with extensions</a>) for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=533038">a bug Taras filed</a> about extension-caused file IO.</li>
<li>I also traced shell calls in the startup path, and found <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=550310">some weirdness</a>, and yeah there are a bunch more calls with the top 10 extensions installed (<a href="http://people.mozilla.com/~dietrich/exec.txt">empty</a>, <a href="http://people.mozilla.com/~dietrich/exec.extensions.txt">with extensions</a>). Things like this should be &quot;advertised&quot; on extensions&#39; pages on AMO. I&#39;m pretty sure there&#39;s already some movement towards Talos testing extensions and posting results on AMO. I&#39;ll file a bug for getting things like this watched as well.</li>
<li>Taras has been making progress using <a href="http://valgrind.org/">Valgrind</a> to get the function and data ordering sequence for <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=531406">improving code locality in our binaries</a>.</li>
<li>Ryan patched and landed a change to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=549788">increase the buffer size used when reading in JSON files</a> (something the search service does during startup).</li>
</ul>
]]></description><link>/2010/03/firefox-startup-performance-march-5-2010/index.html</link><guid isPermaLink="true">/2010/03/firefox-startup-performance-march-5-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 06 Mar 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Graph Server Improvements]]></title><description><![CDATA[<p>The <a href="http://graphs.mozilla.org/">graph server</a> is a powerful tool for visualizing the results of our performance tests over time. However, it has a few major problems that make using it in it&#39;s current form difficult. It also lacks a few features that would make it far more useful for tasks such as regression-finding. I and a few other people are looking into improving the graph server. Before starting though, we need to know how you use the graph server, and your ideas for how the interface could be improved, so please let me know your thoughts in the comments!</p>
<p><img src="graphserver1.png" alt="graph server" title="graph server"></p>
]]></description><link>/2010/02/graph-server-improvements/index.html</link><guid isPermaLink="true">/2010/02/graph-server-improvements/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[graph]]></category><category><![CDATA[server]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sun, 28 Feb 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - Stardate 2.27.2010]]></title><description><![CDATA[<p>Instead of copying around the table of high-priority startup projects, it&#39;s now centrally located and updated on the <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements#Active_Projects">Startup wiki page</a>. A couple of front-end optimizations landed this week:</p>
<ul>
<li>Neil landed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=354048">bug 354048</a> to not rebuild toolbars at startup.</li>
<li>Ryan landed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=522842">bug 522842</a> for the search service to not send notifications until all engines are loaded.
I&#39;ll be in Mountain View all next week for the Firefox work-week.</li>
</ul>
]]></description><link>/2010/02/firefox-startup-performance-stardate-2-27-2010/index.html</link><guid isPermaLink="true">/2010/02/firefox-startup-performance-stardate-2-27-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sun, 28 Feb 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - Feb 19, 2010]]></title><description><![CDATA[<p>Taras <a href="http://blog.mozilla.com/tglek/2010/02/19/teaching-ld-to-optimize-binaries-for-startup/">blogged  about the function ordering work</a> he did while on vacation in Fiji  (?!). Looks like the potential for a minimum 10% win there, very exciting. Follow along in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=531406">bug 531406</a>.</p>
<p>Other than that, no major updates:</p>
<ul>
<li>Zack found surprisingly large performance wins just from deCOMtamination  patches in his CSS work. If you want to help out, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=105431" title="https://bugzilla.mozilla.org/show_bug.cgi?id=105431">bug 105431</a> is the deCOM tracker bug, and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=545052" title="https://bugzilla.mozilla.org/show_bug.cgi?id=545052">bug 545052</a> is about building tools for automating deCOMtamination.</li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">Static  build</a>: Still in reviews, need to figure out approach to binary tests  on the tinderbox.</li>
<li>Ben&#39;s <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=520309">fastload cache replacement</a> is still waiting on first-review from Ben Smedberg.</li>
<li>B<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=354048">ug 354048</a> to not rebuild toolbars at startup, still cycling through reviews.</li>
</ul>
]]></description><link>/2010/02/firefox-startup-performance-feb-19-2010/index.html</link><guid isPermaLink="true">/2010/02/firefox-startup-performance-feb-19-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 20 Feb 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - Feb 11, 2010]]></title><description><![CDATA[<p>Various minor updates this week:</p>
<ul>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">Static build</a>: Ted did the first pass of review. Getting close. Will land on the Places branch once binary tests build, to see perf impact.</li>
<li>Ben&#39;s <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=520309">fastload cache replacement</a> is still waiting on first-review from Ben Smedberg.</li>
<li>Neil took up <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=354048">bug 354048</a> to not rebuild toolbars at startup, should reduce the DOM activity some at least. The patch is in review by Dao and Mano.</li>
<li>Marco has nearly completed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=542943">bug 542943</a>, removing the bookmark redirect hash, which means less SQL at startup and less memory usage by the bookmarks service.</li>
<li>I put a patch up on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=545516">bug 545516</a> that fixes some bugs and cleans up the layout of the <a href="http://graphs.mozilla.org/dashboard/snapshot/">Performance Snapshot</a>. Will get it landed next week.</li>
<li>Started working with John O&#39;Duinn and Mike Morgan to get a team together to work on the graph server.</li>
</ul>
]]></description><link>/2010/02/firefox-startup-performance-feb-11-2010/index.html</link><guid isPermaLink="true">/2010/02/firefox-startup-performance-feb-11-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Fri, 12 Feb 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - Feb 5, 2010]]></title><description><![CDATA[<p>Nothing major to report. Some of the big projects are in the final stretch, which is great to see.</p>
<ul>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">Static build</a>: Joel&#39;s in cleanup phase, making sure the mobile tinderboxes build with the changes. Core patch is waiting on first review from Ted.</li>
<li>Ben&#39;s <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=520309">fastload cache replacement</a> is waiting on first-review from Ben Smedberg.</li>
<li>Zach has <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513149#c22">more data</a> on the effect of the CSS parser optimizations he&#39;s been working on.</li>
<li><p>Asaf put up an <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=528884">experimental patch</a> for making the bookmarks toolbar all JS, no XBL.
Related work I did this week:</p>
</li>
<li><p>Started updating the <a href="http://graphs.mozilla.org/dashboard/snapshot/">Performance Snapshot</a>. Fixing a couple of bugs and making the percentages relative to the 3.6 branch.</p>
</li>
<li>Spent some time poking at the graph server. It&#39;s got serious performance problems, and is lacking a few features that&#39;d make it immensely useful, instead of only somewhat useful. It just needs a little love, that&#39;s all.</li>
<li>Landed <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=506471">bug  506471</a>, moving FUEL out of the startup path.</li>
</ul>
]]></description><link>/2010/02/firefox-startup-performance-feb-5-2010/index.html</link><guid isPermaLink="true">/2010/02/firefox-startup-performance-feb-5-2010/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 06 Feb 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - January 29]]></title><description><![CDATA[<p>No big changes from last week, so I&#39;m not going to knock you over the head with the big table, but here are some notes on the progress of some of the projects and areas of research:</p>
<ul>
<li>Joel has patch in Ted&#39;s review queue for the static build changes. He&#39;s also working on getting Windows builds un-broken, with help from Ben Smedberg and Brad Lassey.</li>
<li>Rob Campbell enabled PGO on the Mac, and found no detectable difference in performance. I built PGO on Linux, and found the same. It could be that there&#39;s no improvement to be had. It could be that our profile-generation approach doesn&#39;t target the codepaths that our performance tests measure. Not sure yet!</li>
<li>I talked with Rob Stong about the fast-startup component, and he brought up a bunch of problems with enabling it in multi-user environments. I&#39;m pretty convinced that there&#39;s no way we can ship with it enabled. And I&#39;m still convinced that it should be exposed as an option to users. I did get it actually working on Windows 7, and as expected, first startup post boot was 60% faster. The scary part is that it took 40% of startup to do the rest...</li>
<li>I researched code locality options for Linux, and haven&#39;t yet found a way to specify a function order like you&#39;re able to on Darwin. Joel&#39;s been spending some time looking into this on Mac, but gprof is broken on Snow Leopard - instrumented builds just hang. Boo.</li>
<li>Joel talked with some Apple developers on the Darwin list and got some more information about compressing with HFS+. They thought it was pretty hacky, recommended improving code locality instead (See previous comment about gprof being broken. <em>sigh</em>). Compressing locally does break our code-signed builds, so might not be feasible anyways. Next is to look into compressing on the release side.</li>
</ul>
]]></description><link>/2010/01/firefox-startup-performance-jan-29/index.html</link><guid isPermaLink="true">/2010/01/firefox-startup-performance-jan-29/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 30 Jan 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox Startup Performance - January 22]]></title><description><![CDATA[<p>A good week: Firefox 3.6 was released, and I&#39;ve gotten a lot of feedback from friends and colleagues that startup has improved, and that it&#39;s snappier than ever. Yesterday I blogged <a href="http://autonome.wordpress.com/2010/01/21/firefox-3-6-performance-startup-and-snappiness-improvements/">a roundup of the performance improvements in Firefox 3.6</a>.</p>
<p>Top Startup Bugs
<!-- table#ts { border: 1px solid silver; } --></p>
<p><table id="ts" border="1" cellspacing="0" cellpadding="2"></p>
<p><tbody></p>
<p><tr></p>
<p><td class="s0">Estimated win</td></p>
<p><td class="s1">Bug #</td></p>
<p><td class="s1">Summary</td></p>
<p><td class="s1">Owner</td></p>
<p><td class="s1">Status</td></p>
<p><td class="s1">Notes</td>
</tr></p>
<p><tr></p>
<p><td class="s2">&gt;10%</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=512584">512584</a></td></p>
<p><td class="s4">Super fast paths for Components.classes and Components.interfaces</td></p>
<p><td class="s4">Taras Glek</td></p>
<p><td class="s4">in progress</td></p>
<p><td>Taras is traveling, says he&#39;ll close it out when he returns.</td>
</tr></p>
<p><tr></p>
<p><td class="s2">&gt;10%</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=525013">525013</a></td></p>
<p><td class="s4">Investigate a more static build configuration of Firefox</td></p>
<p><td class="s4">Joel Reymont</td></p>
<p><td class="s4">in progress</td></p>
<p><td class="s4">More great data from Zack and Joel. See PDF charts of the different build configurations tested on different hard-drive speeds for <a href="https://bugzilla.mozilla.org/attachment.cgi?id=422607">Mac</a> and for <a href="https://bugzilla.mozilla.org/attachment.cgi?id=423007">Linux</a>.</td>
</tr></p>
<p><tr></p>
<p><td class="s2">up to 25%</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=514083">514083</a></td></p>
<p><td class="s4">Per-file HFS+ compression on Mac OSX 10.6</td></p>
<p><td class="s4">Joel Reymont</td></p>
<p><td class="s4">in progress</td></p>
<p><td class="s4">Conclusion is that we need to make this happen via the installer, as well as the updater, since modifying files results in decompression. Need to find an owner for this still.</td>
</tr></p>
<p><tr></p>
<p><td class="s2">TBD</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=520309">520309</a></td></p>
<p><td class="s4">Startup cache: replacement for fastload cache</td></p>
<p><td class="s4">Ben Hsieh</td></p>
<p><td class="s4">in progress</td></p>
<p><td class="s4">Considering moving back to the simpler caching approach.</td>
</tr></p>
<p><tr></p>
<p><td class="s2">TBD</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=503483">503483</a></td></p>
<p><td class="s4">Turn on --enable-faststart for Firefox by default</td></p>
<p><td class="s4">Dietrich</td></p>
<p><td class="s4">needs testing</td></p>
<p><td class="s4">Started talking with Rob Strong about making the changes to the NSIS installer to make this happen.</td>
</tr></p>
<p><tr></p>
<p><td class="s2">TBD</td></p>
<p><td class="s3"><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513149">513149</a></td></p>
<p><td class="s4">Speed up CSS parsing by using a machine generated lexer</td></p>
<p><td class="s4">Zack Weinberg</td></p>
<p><td class="s4">Zack&#39;s blocked on other work</td></p>
<p><td class="s4">No update.Taras says about 6% of startup spent parsing CSS.</td>
</tr>
</tbody>
</table>
Other activity this week:</p>
<ul>
<li>Of the bugs I filed as a result of the JS profiling data (<a href="http://spreadsheets.google.com/pub?key=t98ryMyoZx3Su0Pw7wz0anQ&amp;output=html">ranked log</a>, <a href="http://people.mozilla.org/~dietrich/startup-js-win.txt">stack view</a>), we closed out <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=539991">bug 539991</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=539870">bug  539870</a>, and have owners and patches on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=539869">bug 539869</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=539997">bug  539997</a>.</li>
<li>I figured out the leak on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=506471">bug 506471</a>, to move FUEL out of the startup path, and will have review soon.</li>
<li>Taras posted <a href="http://blog.mozilla.com/tglek/2010/01/19/chromium-vs-minefield-cold-startup-performance-comparison/">a comparison of the startup time on Linux with a new profile for Chromium and Minefield</a>. Good data... for Linux users, but the lesson here is that we urgently need a canonical dirty profile to test with. I&#39;m going to get with the Test Pilot folks to see about gathering the data to do this.</li>
<li><p>Also, I found another post from Taras that I missed while I was out for the holidays, detailing the problems with <a href="http://blog.mozilla.com/tglek/2010/01/04/windows-7-startup-exploration/">measuring cold startup on Windows</a>.
Projects in a holding pattern:</p>
</li>
<li><p>More investigation into Hunspell changes in <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=468779">bug  468799</a>, possibly incorporating some changes Chrome made.</p>
</li>
<li>Ryan Flint has a WIP patch to minify JS on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=524858">bug  524858</a> that significantly reduces the size of shipped JavaScript  files.</li>
<li>JARification: David abandoned <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=509755">moving JS          modules into a JAR file</a>, since those files are fastloaded.         However, since we want things like post-extension-install  restarts  to   be     fast, and those cause fastload cache invalidation,  we might   want  to   do   things like this anyways. I filed a bug for  the same   treatment  for     components. These are lower priority,  since they&#39;re   not the  normal     startup case. Follow along with all  JAR-ification   via<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513027"> the         tracker  bug</a>.</li>
<li>Startup Timeline: No updates, still not landed. Add [ft] in the        whiteboard of your bug w/ the function names you want timed and David        will generate it and update the bug.</li>
<li>Static Analysis: No progress on <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=506128">bug        506128</a>.  David needs to file a bug with the final log of        named-yet-uncalled  functions.</li>
<li>Dirty Profile Testing: No progress. We have <a href="https://wiki.mozilla.org/Firefox/Sprints/Startup_Time_Improvements#Test_Coverage">a list of test scenarios</a>, still need to file        bugs  for each, generate Talos config patches and profile data, and    then     move  it into Rel-Eng territory. Also, need to get a separate       Tinderbox  tree,  since it&#39;s going to cause a bazillion new  columns.</li>
<li><a href="http://wagerlabs.com/">Joel        Reymont</a> noted in<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=513076"> bug        513076</a> that there are serious drawbacks to getting our libraries  in       the dyld  shared cache on Mac, so has deprioritized that work.
As usual, more details and links are  available on <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements">the       project wiki</a>, and we&#39;re available to answer questions in <a href="irc://irc.mozilla.org/#startup">#startup on irc.mozilla.org</a>.</li>
</ul>
]]></description><link>/2010/01/firefox-startup-performance-january-22/index.html</link><guid isPermaLink="true">/2010/01/firefox-startup-performance-january-22/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Sat, 23 Jan 2010 00:00:00 GMT</pubDate></item><item><title><![CDATA[Firefox 3.6 Performance: Startup and Snappiness Improvements]]></title><description><![CDATA[<p><a href="http://bit.ly/blogfx36">Firefox 3.6 was released today</a>! For me, the most important changes in this release are the performance and stability improvements. On Mac especially, there are some big improvements in startup time, yielding up to 30% faster startup generally. And on both Mac and Windows, we fixed some pathologically bad startup scenarios.</p>
<p>The list of bugs fixed that specifically affect startup time is <a href="http://bit.ly/5t9fA9">here</a>, however a few should be called out individually:</p>
<ul>
<li><a href="http://ted.mielczarek.org/">Ted Mielczarek</a> and <a href="http://blog.mozilla.com/adw/">Drew Willcoxon</a> <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=463605">combined all .xpt files into a single one</a>, reducing the number of files read from the disk at startup.</li>
<li><a href="http://blog.mozilla.com/rstrong/">Rob Strong</a> <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=471219">removed the need for services to load at startup for timer registration</a>, reducing the number of files read from disk at startup, as well as reducing the amount of JavaScript executed. There are still services that need to be ported to this new scheme, so expect more improvements here.</li>
<li><a href="http://blog.vlad1.com/">Vlad Vukicevic</a> found that on Mac it could <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=506470">take up to a whole second to initialize Growl</a>, if present. His fix initializes Growl on demand.</li>
<li><a href="http://wagerlabs.com/">Joel Reymont</a> found that up to 10% of startup time on Mac was in the initialization of fonts. <a href="http://blog.mozilla.com/nattokirai/">John Daggett</a> and Jonathan Kew <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=517045">did some great work to reduce the problem in Firefox 3.6</a>. They subsequently <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=519445">modified font loading on Mac to occur on-demand</a>, so the next release will be even faster.</li>
<li>Joel also found that up to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=517549">12% of startup on Mac was spent in some APIs that were only needed for debugging</a>. The problem was quickly fixed by Masayuki Nakano.</li>
<li><a href="http://blog.mozilla.com/tglek/">Taras Glek</a> and Alfred Kayser spent a bunch of time <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=504864">improving the performance of how JARs are loaded and read from</a>. The infrastructure improvements made are paying off as we move more groups of small files into these archives, reducing the number of individual file operations that occur at startup time.</li>
<li><p>On Windows, it was found that <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=501605">a large portion of startup time was spent in the security libraries</a>, building up entropy by trawling through IE&#39;s cache folder and the Windows temp directory. Some Windows users reported upwards of 25k files in their temp directories, so you can imagine the delays that this behavior was causing for some users. The behavior is now fixed.
The full list of bugs fixed in Firefox 3.6 with the &quot;perf&quot; keyword is <a href="http://bit.ly/7Y6gqE">here</a>. These range from improvements to web page loading times, general UI responsiveness, and improvements to specific UI actions such as searching History and Bookmarks:</p>
</li>
<li><p>One of the biggest improvements is that <a href="http://shawnwilsher.com/">Shawn Wilsher</a> ported all of the Awesomebar code to JavaScript and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=455555">moved the queries that build up the results to a background thread</a>. This resulted in a massive improvement in UI responsiveness when typing in the location bar.</p>
</li>
<li>Another infrastructural improvement that will affect general responsiveness is <a href="http://blog.bonardo.net/">Marco Bonardo</a>&#39;s work to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=512854">clean up the bookmarks and history database periodically</a>.</li>
<li>Per-tab-network-prioritization is the long way of saying that Firefox will prioritize the network traffic of pages you are currently interacting with. <a href="http://zpao.com/articles/22-per_tab_network_prioritization">Paul O&#39;Shannessy explains the feature here</a>, and was able to <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=514490">finish it up in time to make 3.6</a>.</li>
<li>Finally, there are a TON of performance improvements to the JavaScript engine, which benefit just about every area of the browser, from startup time to page loading to extensions. <a href="http://blog.mozilla.com/dmandelin/">Dave Mandelin</a> put up <a href="http://hacks.mozilla.org/2010/01/javascript-speedups-in-firefox-3-6/">a detailed post on Hacks.Mozilla.org</a> last week that explains it all.
And all of this is just a taste of what&#39;s to come: Over 60% of the bugs fixed as part of our focus on startup performance have landed on trunk, but didn&#39;t make it in time for the 3.6 release. You can follow along on the <a href="https://wiki.mozilla.org/Firefox/Projects/Startup_Time_Improvements">wiki page for the startup project</a>, and here on my blog, where I post status updates every Friday.</li>
</ul>
]]></description><link>/2010/01/firefox-3-6-performance-startup-and-snappiness-improvements/index.html</link><guid isPermaLink="true">/2010/01/firefox-3-6-performance-startup-and-snappiness-improvements/index.html</guid><category><![CDATA[firefox]]></category><category><![CDATA[firefox]]></category><category><![CDATA[Firefox3.6]]></category><category><![CDATA[Mac]]></category><category><![CDATA[mozilla]]></category><category><![CDATA[Performance]]></category><category><![CDATA[startup]]></category><dc:creator><![CDATA[Dietrich Ayala]]></dc:creator><pubDate>Fri, 22 Jan 2010 00:00:00 GMT</pubDate></item></channel></rss>